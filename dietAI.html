<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>מעקב תזונה</title>
  <style>
  .nutrients {
    display: flex;
    gap: 20px;
    margin-top: 10px;
  }
  .nutrients div {
    background: #ecf0f1;
    padding: 10px;
    border-radius: 8px;
    min-width: 100px;
    text-align: center;
    font-weight: bold;
  }
  .nutrients div span {
    display: block;
    font-size: 18px;
    color: #27ae60;
  }
    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
      margin: 20px;
      background: #f8f9fa;
      color: #333;
    }
    h2 {
      color: #2c3e50;
    }
    .nutrition {
      background: #fff;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    .nutrition strong {
      color: #27ae60;
    }
    .advice {
      background: #e8f5e9;
      border-right: 5px solid #2ecc71;
      padding: 15px;
      border-radius: 8px;
    }
    ul {
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h1>Diet App</h1>

  <div class="nutrition">
  <p><strong>סיכום יומי:</strong></p>
  <div id="summary" class="nutrients"></div>
</div>

  <form id="dietForm">
    <table border="1" cellpadding="5" cellspacing="0">
      <thead>
        <tr>
          <th>Amount</th>
          <th>Food Type</th>
          <th>Calories</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><input type="text" id="amount" required /></td>
          <td><input type="text" id="food_type" required /></td>
          <td><input type="text" id="calories" required /></td>
        </tr>
      </tbody>
    </table>
    <br />
    <button type="submit">Send</button>
  </form>

  <div id="aiResponse"></div>

<script>

let totals = JSON.parse(localStorage.getItem("totals")) || {
  "קלוריות": 0,
  "שומנים": 0,
  "חלבונים": 0,
  "פחמימות": 0
};

function renderSummary() {
  let html = "";
  for (let key in totals) {
    html += `<div>${key}<span>${totals[key]}</span></div>`;
  }
  document.getElementById("summary").innerHTML = html;
  localStorage.setItem("totals", JSON.stringify(totals));
}

renderSummary();
function parseAI(text){
	for (let key in totals){
		
	}
	
}
function updateSummary() {
  document.getElementById("summary").textContent = JSON.stringify(totals);
}

document.getElementById("dietForm").addEventListener("submit", async (e) => {
  e.preventDefault();

  const amount = document.getElementById("amount").value;
  const foodType = document.getElementById("food_type").value;
  const calories = document.getElementById("calories").value;

  const content = `
  תאריך את הקלוריות פחממות שומנים וחלבונים לפי המידע הבא:
  amount:${amount}, food_type:${foodType}, calories:${calories}
  תענה בדפוס הבא: 
  שומנים:תשובה
  חלבונים:תשובה
  פחמימות:תשובה
  קלוריות:תשובה
  ותן עצה תזונאית לחולי סכרת
  נסח הכל בתצוגה גרפית של HTML
  `;

  try {
    const response = await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=AIzaSyBa4jzkEs9sNpgzYKyurki15StczuOsUlU", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        contents: [{ parts: [{ text: content }] }]
      })
    });

    const data = await response.json();
    const text = data.candidates?.[0]?.content?.parts?.[0]?.text || "No response";

    
    updateSummary(parseAI(text));
    document.getElementById("aiResponse").innerHTML = text;

  } catch (err) {
    document.getElementById("aiResponse").textContent = "Error: " + err;
  }
});




</script>
</body>
</html>

